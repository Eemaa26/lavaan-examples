<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>Example 2 from Rossel&#39;s Paper on lavaan</title>

<base target="_blank"/>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
}

pre code {
   display: block; padding: 0.5em;
}

code.r {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>Example 2 from Rossel&#39;s Paper on lavaan</h1>

<pre><code class="r">library(lavaan)
Data &lt;- PoliticalDemocracy
</code></pre>

<p>This example is an elaboration on Example 2 from Yves Rossel&#39;s Journal of Statistical Software Article (see <a href="http://www.jstatsoft.org/v48/i02/paper">here</a>).</p>

<h2>M0: Basic Measurement model</h2>

<pre><code class="r">m0_model &lt;- &#39;
# measurement model
ind60 =~ x1 + x2 + x3
dem60 =~ y1 + y2 + y3 + y4
dem65 =~ y5 + y6 + y7 + y8
&#39;

m0_fit &lt;- cfa(m0_model, data=Data)
</code></pre>

<ul>
<li><code>m0</code> defines a basic measurement model that permits correlated factors.  Note that it does not have correlations between corresponding democracy indicator measures over time.</li>
</ul>

<p><strong>Questions:</strong></p>

<ul>
<li>Is it a good model?</li>
</ul>

<pre><code class="r">fitmeasures(m0_fit)
</code></pre>

<pre><code>##             chisq                df            pvalue    baseline.chisq 
##            72.462            41.000             0.002           730.654 
##       baseline.df   baseline.pvalue               cfi               tli 
##            55.000             0.000             0.953             0.938 
##              logl unrestricted.logl              npar               aic 
##         -1564.959         -1528.728            25.000          3179.918 
##               bic            ntotal              bic2             rmsea 
##          3237.855            75.000          3159.062             0.101 
##    rmsea.ci.lower    rmsea.ci.upper      rmsea.pvalue              srmr 
##             0.061             0.139             0.021             0.055 
</code></pre>

<ul>
<li>cfi suggests a reasonable model, but RMSEA is quite large.</li>
</ul>

<pre><code class="r">inspect(m0_fit, &#39;standardized&#39;)
</code></pre>

<pre><code>##      lhs op   rhs est.std se  z pvalue
## 1  ind60 =~    x1   0.920 NA NA     NA
## 2  ind60 =~    x2   0.973 NA NA     NA
## 3  ind60 =~    x3   0.872 NA NA     NA
## 4  dem60 =~    y1   0.845 NA NA     NA
## 5  dem60 =~    y2   0.760 NA NA     NA
## 6  dem60 =~    y3   0.705 NA NA     NA
## 7  dem60 =~    y4   0.860 NA NA     NA
## 8  dem65 =~    y5   0.803 NA NA     NA
## 9  dem65 =~    y6   0.783 NA NA     NA
## 10 dem65 =~    y7   0.819 NA NA     NA
## 11 dem65 =~    y8   0.847 NA NA     NA
## 12    x1 ~~    x1   0.154 NA NA     NA
## 13    x2 ~~    x2   0.053 NA NA     NA
## 14    x3 ~~    x3   0.240 NA NA     NA
## 15    y1 ~~    y1   0.286 NA NA     NA
## 16    y2 ~~    y2   0.422 NA NA     NA
## 17    y3 ~~    y3   0.503 NA NA     NA
## 18    y4 ~~    y4   0.261 NA NA     NA
## 19    y5 ~~    y5   0.355 NA NA     NA
## 20    y6 ~~    y6   0.387 NA NA     NA
## 21    y7 ~~    y7   0.329 NA NA     NA
## 22    y8 ~~    y8   0.283 NA NA     NA
## 23 ind60 ~~ ind60   1.000 NA NA     NA
## 24 dem60 ~~ dem60   1.000 NA NA     NA
## 25 dem65 ~~ dem65   1.000 NA NA     NA
## 26 ind60 ~~ dem60   0.448 NA NA     NA
## 27 ind60 ~~ dem65   0.555 NA NA     NA
## 28 dem60 ~~ dem65   0.978 NA NA     NA
</code></pre>

<ul>
<li>The table of standardised loadings show all factor loadings to be large.</li>
</ul>

<pre><code class="r">m0_mod &lt;- modificationindices(m0_fit)
head(m0_mod[order(m0_mod$mi, decreasing=TRUE), ], 12)
</code></pre>

<pre><code>##      lhs op rhs    mi    epc sepc.lv sepc.all sepc.nox
## 1     y2 ~~  y6 9.279  2.129   2.129    0.162    0.162
## 2     y6 ~~  y8 8.668  1.513   1.513    0.140    0.140
## 3     y1 ~~  y5 8.183  0.884   0.884    0.131    0.131
## 4     y3 ~~  y6 6.574 -1.590  -1.590   -0.146   -0.146
## 5     y1 ~~  y3 5.204  1.024   1.024    0.121    0.121
## 6     y2 ~~  y4 4.911  1.432   1.432    0.110    0.110
## 7     y3 ~~  y7 4.088  1.152   1.152    0.108    0.108
## 8  ind60 =~  y5 4.007  0.762   0.510    0.197    0.197
## 9     x1 ~~  y2 3.785 -0.192  -0.192   -0.067   -0.067
## 10 ind60 =~  y4 3.568  0.811   0.543    0.163    0.163
## 11    y2 ~~  y3 3.215 -1.365  -1.365   -0.107   -0.107
## 12    y5 ~~  y6 3.116 -0.774  -0.774   -0.089   -0.089
</code></pre>

<ul>
<li>The table of largest modification indices suggest a range of ways that the model could be improved. Because the sample size is small, particular caution needs to be taken with these.</li>
<li>Several of these modifications concern the expected requirement to permit indicator variables at different time points to correlate (e.g., <code>y2</code> with <code>y6</code>, <code>y3</code> with <code>y7</code>).</li>
<li>It may also be that some pairs of items are correlated more than others. For example, the following correlation matrix shows how <code>y6</code> and <code>y8</code> have a particularly large correlation.</li>
</ul>

<pre><code class="r">round(cor(Data[,c(&#39;y5&#39;, &#39;y6&#39;, &#39;y7&#39;, &#39;y8&#39;)]), 2)
</code></pre>

<pre><code>##      y5   y6   y7   y8
## y5 1.00 0.56 0.68 0.63
## y6 0.56 1.00 0.61 0.75
## y7 0.68 0.61 1.00 0.71
## y8 0.63 0.75 0.71 1.00
</code></pre>

<ul>
<li>What are the correlations between the factors?</li>
</ul>

<pre><code class="r">cov2cor(inspect(m0_fit, &quot;coefficients&quot;)$psi)
</code></pre>

<pre><code>##       ind60 dem60 dem65
## ind60 1.000            
## dem60 0.448 1.000      
## dem65 0.555 0.978 1.000
</code></pre>

<p>This certainly suggests that factors are strongly related, especially the two demographics measures.</p>

<h2>M1: Correlated item measurement model</h2>

<p>This next model permits corresponding democracy measures from the two points to be correlated.</p>

<pre><code class="r">m1_model &lt;- &#39;
    # measurement model
    ind60 =~ x1 + x2 + x3
    dem60 =~ y1 + y2 + y3 + y4
    dem65 =~ y5 + y6 + y7 + y8

    # correlated residuals
    y1 ~~ y5
    y2 ~~ y6
    y3 ~~ y7
    y4 ~~ y8
&#39;

m1_fit &lt;- cfa(m1_model, data=Data)
</code></pre>

<ul>
<li>Is this an improvement over <code>m0</code> with uncorrelated indicators?</li>
<li>Does <code>m1</code> have good fit in and of itself?</li>
</ul>

<pre><code class="r">anova(m0_fit, m1_fit)
</code></pre>

<pre><code>## Chi Square Difference Test
## 
##        Df  AIC  BIC Chisq Chisq diff Df diff Pr(&gt;Chisq)    
## m1_fit 37 3166 3233  50.8                                  
## m0_fit 41 3180 3238  72.5       21.6       4    0.00024 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
</code></pre>

<pre><code class="r">round(cbind(m0=inspect(m0_fit, &#39;fit.measures&#39;), 
            m1=inspect(m1_fit, &#39;fit.measures&#39;)), 3)
</code></pre>

<pre><code>##                          m0        m1
## chisq                72.462    50.835
## df                   41.000    37.000
## pvalue                0.002     0.064
## baseline.chisq      730.654   730.654
## baseline.df          55.000    55.000
## baseline.pvalue       0.000     0.000
## cfi                   0.953     0.980
## tli                   0.938     0.970
## logl              -1564.959 -1554.146
## unrestricted.logl -1528.728 -1528.728
## npar                 25.000    29.000
## aic                3179.918  3166.292
## bic                3237.855  3233.499
## ntotal               75.000    75.000
## bic2               3159.062  3142.099
## rmsea                 0.101     0.071
## rmsea.ci.lower        0.061     0.000
## rmsea.ci.upper        0.139     0.115
## rmsea.pvalue          0.021     0.234
## srmr                  0.055     0.050
</code></pre>

<ul>
<li>It is a significant improvement. </li>
<li>RMSEA and other fit measurs are substantially improved.</li>
<li>The relatively small sample size makes it somewhat difficult to see how much further improvements should continue. In general, the RMSEA suggests that further improvements are possible but it may be less clear on how to proceed in a principled way.</li>
</ul>

<h1>M2: Basic SEM</h1>

<pre><code class="r">m2_model &lt;- &#39;
    # measurement model
    ind60 =~ x1 + x2 + x3
    dem60 =~ y1 + y2 + y3 + y4
    dem65 =~ y5 + y6 + y7 + y8

    # correlated residuals
    y1 ~~ y5
    y2 ~~ y6
    y3 ~~ y7
    y4 ~~ y8

    # regressions
    dem60 ~ ind60
    dem65 ~ ind60 + dem60
&#39;

m2_fit &lt;- sem(m2_model, data=Data)
</code></pre>

<ul>
<li>Is fit the same as model 1 as I would expect?</li>
</ul>

<pre><code class="r">rbind(m1 = fitMeasures(m1_fit)[c(&#39;chisq&#39;, &#39;rmsea&#39;)], 
    m2 = fitMeasures(m2_fit)[c(&#39;chisq&#39;, &#39;rmsea&#39;)])
</code></pre>

<pre><code>##    chisq   rmsea
## m1 50.84 0.07061
## m2 50.84 0.07061
</code></pre>

<p>Yes, it is.</p>

<ul>
<li>Assuming democracy 1965 is the depenent variable, how can we get the information typically available in multiple regression output?

<ul>
<li>R-squared?</li>
<li>Unstandardised regression coefficients?</li>
<li>Standardised regression coefficients?</li>
<li>Standard errors, p-values,  and confidence intervals on unstandardised coefficients?</li>
</ul></li>
</ul>

<pre><code class="r"># m2_fit &lt;- sem(m2_model, data=Data)

# r-square for dem-65
inspect(m2_fit, &#39;r2&#39;)[&#39;dem65&#39;]
</code></pre>

<pre><code>##  dem65 
## 0.9139 
</code></pre>

<pre><code class="r">
# Unstandardised regression coefficients
inspect(m2_fit, &#39;coef&#39;)$beta[&#39;dem65&#39;, ]
</code></pre>

<pre><code>##  ind60  dem60  dem65 
## 0.5069 0.8157 0.0000 
</code></pre>

<pre><code class="r">
# Standardised regression coefficients
subset(inspect(m2_fit, &#39;standardized&#39;), lhs == &#39;dem65&#39; &amp; op == &#39;~&#39;)
</code></pre>

<pre><code>##     lhs op   rhs est.std se  z pvalue
## 1 dem65  ~ ind60   0.168 NA NA     NA
## 2 dem65  ~ dem60   0.869 NA NA     NA
</code></pre>

<pre><code class="r">
# Just a guess, may not be correct:
# coefs &lt;- data.frame(coef=inspect(m2_fit, &#39;coef&#39;)$beta[&#39;dem65&#39;, ],
#       se=inspect(m2_fit, &#39;se&#39;)$beta[&#39;dem65&#39;, ])
# coefs$low95ci &lt;- coefs$coef - coefs$se * 1.96
# coefs$high95ci &lt;- coefs$coef + coefs$se * 1.96
</code></pre>

</body>

</html>

